   Bitcoin: Fidarsi o non Fidarsi?
                                            Luca Grilli, DI UniPG
01 Siena, Auditorium Banca MPS - 15/11/2018             Prof. Luca Grilli, DI UniPG

                                    Sommario
   • Prologo
   • Perché il BTC?
   • Come funziona il BTC?
   • Conclusioni
02  Bitcoin: Fidarsi o non Fidarsi?          Prof. Luca Grilli, DI UniPG

                                   Prologo
03 Bitcoin: Fidarsi o non Fidarsi?         Prof. Luca Grilli, DI UniPG

         Una storiella per iniziare …
   • nel 2009
         – studente norvegese       Kristoffer Koch
         – acquistò 5600 BTC con
             19 € (150 corone)
04  Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

         Una storiella per iniziare …
   • nel 2009
         – studente norvegese       Kristoffer Koch
         – acquistò 5600 BTC con
             19 € (150 corone)
   • … poi dimenticò …
05  Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

         Una storiella per iniziare …
   • nel 2009
         – studente norvegese       Kristoffer Koch
         – acquistò 5600 BTC con
             19 € (150 corone)
   • … poi dimenticò …
   • nel 2013
         – 1 BTC = 205 €
         – Koch era MILIONARIO!!!
06  Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

              … ma che cos’è il Bitcoin?
   • Possibile definizione
         – il bitcoin è una critto-valuta digitale introdotta
             nel 2009 da Satoshi Nakamoto
07  Bitcoin: Fidarsi o non Fidarsi?              Prof. Luca Grilli, DI UniPG

              … ma che cos’è il Bitcoin?
   • Possibile definizione
         – il bitcoin è una critto-valuta digitale introdotta
             nel 2009 da Satoshi Nakamoto
   • Perché il Bitcoin? Come funziona?
         – speriamo di chiarirlo oggi
         – … ma molti misteri rimangono
08  Bitcoin: Fidarsi o non Fidarsi?              Prof. Luca Grilli, DI UniPG

              … ma che cos’è il Bitcoin?
   • Possibile definizione
         – il bitcoin è una critto-valuta digitale introdotta
             nel 2009 da Satoshi Nakamoto
   • Perché il Bitcoin? Come funziona?
         – speriamo di chiarirlo oggi
         – … ma molti misteri rimangono
   • Primo mistero
         – chi è Satoshi Nakamoto?
09  Bitcoin: Fidarsi o non Fidarsi?              Prof. Luca Grilli, DI UniPG

                                   Chi è Satoshi
                                   Nakamoto?
      è Dorian Satoshi Nakamoto?
10 Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

                                   Chi è Satoshi
                                   Nakamoto?
      Dorian S. Nakamoto NEGA
11 Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

                                   Chi è Satoshi
                                   Nakamoto?
      è Tatsuaki Okamoto, NSA?
12 Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

                                   Chi è Satoshi
                                   Nakamoto?
   è Yuto Nagatomo, ex FC Inter?
13 Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

                                    Chi è Satoshi
                                    Nakamoto?
   per chi vuole fare un regalo!
14  Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

                                   Chi è Satoshi
                                   Nakamoto?
           è ancora un mistero!
15 Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

                    … BTC e anonimato …
16 Bitcoin: Fidarsi o non Fidarsi?    Prof. Luca Grilli, DI UniPG

                                   BTC e BlackMarket
16 Bitcoin: Fidarsi o non Fidarsi?           Prof. Luca Grilli, DI UniPG

                     Bitcoin vs Blockchain
                                       BTC
                                   Blockchain
18 Bitcoin: Fidarsi o non Fidarsi?            Prof. Luca Grilli, DI UniPG

                    Perché il Bitcoin?
19 Bitcoin: Fidarsi o non Fidarsi?     Prof. Luca Grilli, DI UniPG

     Verità e Fiducia: 2 problemi centrali
   • Verità: capacità di ricostruire la storia esatta
       di come fatti/eventi sono avvenuti
   • In informatica: fatti = informazioni
         – verità <U+F0DB> capacità di gestire una struttura dati
             (logica) rappresentativa della realtà e/o coerente
             a determinati vincoli di dominio
   • Fiducia: credere che una certa entità agisca
       in un determinato modo, senza poterlo
       verificare
20  Bitcoin: Fidarsi o non Fidarsi?                  Prof. Luca Grilli, DI UniPG

                       Verità vs Autenticità
   • Autenticità: capacità di verificare se una
       data informazione è stata prodotta e/o
       sottoscritta da una specifica entità (fonte)
                                    autenticità
                                      verità
21  Bitcoin: Fidarsi o non Fidarsi?             Prof. Luca Grilli, DI UniPG

   Autenticità tramite Crittografia
                Fiducia            Prova Crittografica
                                       01001110101001101
                                       01010101001000100
                                       01000100101010000
22 Bitcoin: Fidarsi o non Fidarsi?                Prof. Luca Grilli, DI UniPG

                       Come si realizza una
                       prova crittografica?
23 Bitcoin: Fidarsi o non Fidarsi?          Prof. Luca Grilli, DI UniPG

           Crittografia a chiave segreta
                              (o simmetrica)
                                 K                          K
          m                 E(K, m)          c           D(K, c)                     m
                          CIFRATURA                   DECIFRATURA
                                     m:  testo in chiaro
                                      c: testo cifrato
                                      K: chiave crittografica segreta
                                E(K, m): funzione di cifratura
                                D(K, m): funzione di decifratura
     Bitcoin:classico:
impiego
 22                             protezione della confidenzialità
             Fidarsi o non Fidarsi?                           Prof. Luca Grilli, DI UniPG

            Crittografia a chiave pubblica
                               (o asimmetrica)
   • Anziché una chiave segreta condivisa K
   • Due chiavi accoppiate <U+F0E1>PU, PR<U+F0F1>
         – PU: chiave pubblica, da divulgare
         – PR: chiave privata, da custodire segretamente
   • Impiego
         – protezione della confidenzialità
         – protezione dell’autenticità (firma digitale)
25  Bitcoin: Fidarsi o non Fidarsi?            Prof. Luca Grilli, DI UniPG

         Crittografia a chiave pubblica
                            (o asimmetrica)
                               PUL                          PRL
         m                  E(PUL, m)          c         D(PRL, c)                    m
                          CIFRATURA                    DECIFRATURA
                         m:      testo in chiaro
                           c:    testo cifrato
                       PUL:      chiave pubblica di Lupin
                       PRL:      chiave privata di Lupin
           E(PUL, m):            funzione di cifratura a chiave pubblica
           D(PRL, m):            funzione di decifratura a chiave pubblica
impiego:
 24            protezione
    Bitcoin: Fidarsi o non Fidarsi?   della confidenzialità    Prof. Luca Grilli, DI UniPG

                              Firma digitale
                        PRM                 PUM
   m                E(PRM, m)       s     D(PUM, s)
                       FIRMA                                  m
                                                   m
                                    m                       ?              NO
                                          VERIFICA
                                                            =
   s: firma del messaggio m
   SOLO chi conosce PRM può firmare                         SI
   <U+F0DE> solo Margot (dovrebbe) conosce PRM
   Lupin (o chiunque) può verificare l’autenticità
   del messaggio effettuando un semplice test
27  Bitcoin: Fidarsi o non Fidarsi?                 Prof. Luca Grilli, DI UniPG

                                    … quindi ...
   • Firma digitale <U+F0DE> autenticità senza
       doversi fidare
   • Firma digitale ?<U+F0DE>? verità senza doversi
       fidare
28  Bitcoin: Fidarsi o non Fidarsi?              Prof. Luca Grilli, DI UniPG

                                    … quindi …
   • Firma digitale <U+F0DE> autenticità senza
       doversi fidare
   • Firma digitale ?<U+F0DE>? verità senza doversi
       fidare
                                       NO!!!
   • Esistono le MENZOGNE AUTENTICHE
         – falsità prodotte da fonti (crittograficamente)
             verificabili
29  Bitcoin: Fidarsi o non Fidarsi?             Prof. Luca Grilli, DI UniPG

                            Verità <U+F0DE> Fiducia
   • Verità ottenibile tramite
         – verifiche (crittografiche) di autenticità
         – controlli sulla coerenza logica dei dati
         – accessibilità ai dati (trasparenza)
         – immutabilità dati accettati
         –…
   • <U+F0DE> richiede comunque fiducia in chi
       esegue queste verifiche/controlli
         – soprattutto in processi fortemente dinamici
30  Bitcoin: Fidarsi o non Fidarsi?             Prof. Luca Grilli, DI UniPG

   Modelli per la gestione della fiducia
       centralizzato               decentralizzato
       privato                     pubblico
       …                           …
31 Bitcoin: Fidarsi o non Fidarsi? Prof. Luca Grilli, DI UniPG

                        Bitcoin/Blockchain
     Primo esempio di modello decentralizzato
                               aperto e pubblico
32 Bitcoin: Fidarsi o non Fidarsi?               Prof. Luca Grilli, DI UniPG

                             Altri ingredienti
               crittografici fondamentali
33 Bitcoin: Fidarsi o non Fidarsi?             Prof. Luca Grilli, DI UniPG

       Funzioni crittografiche di hash
   • NON richiedono l’uso di una chiave
       crittografica
         – INPUT: stringa binaria di qualsiasi lunghezza
         – OUTPUT: stringa binaria di lunghezza prefissata
             (128 bit, 256 bit, 512 bit)
   • Proprietà
         – pseudo-randomicità (instabilità)
         – resistenza alla preimmagine
         – resistenza alle collisioni
34  Bitcoin: Fidarsi o non Fidarsi?                Prof. Luca Grilli, DI UniPG

           Un hash a 128 bit – MD5
                                    Nel mezzo del cammin di nostra vita
                                    mi ritrovai per una selva oscura
                                    ché la diritta via era smarrita.
                                    Ahi quanto a dir qual era è cosa dura
                                    esta selva selvaggia e aspra e forte
          INPUT                     che nel pensier rinova la paura!
      m <U+F0CE> {0,1}*                    Tant'è amara che poco è più morte;
                                    ma per trattar del ben ch'i' vi trovai,
                                    dirò de l'altre cose ch'i' v'ho scorte.
                                                       MD5
         OUTPUT
   h(m) <U+F0CE> {0,1}128                 c7c35bbb41968390f816a8a6a6dc3932
35 Bitcoin: Fidarsi o non Fidarsi?                             Prof. Luca Grilli, DI UniPG

     Un hash a 256 bit – SHA-256
                                   Nel mezzo del cammin di nostra vita
                                   mi ritrovai per una selva oscura
                                   ché la diritta via era smarrita.
                                   Ahi quanto a dir qual era è cosa dura
                                   esta selva selvaggia e aspra e forte
          INPUT                    che nel pensier rinova la paura!
      m <U+F0CE> {0,1}*                   Tant'è amara che poco è più morte;
                                   ma per trattar del ben ch'i' vi trovai,
                                   dirò de l'altre cose ch'i' v'ho scorte.
          OUTPUT                                    SHA-256
   h(m) <U+F0CE> {0,1}256
   494ac477c5f0b482673dee9d68bfd4d2f41c874a9757a8759ea65b4c79db5c7c
36 Bitcoin: Fidarsi o non Fidarsi?                            Prof. Luca Grilli, DI UniPG

       Hash di messaggi quasi identici
 Nel mezzo del cammin di nostra vita      Nel centro del cammin di nostra vita
 mi ritrovai per una selva oscura         mi ritrovai per una selva oscura
 ché la diritta via era smarrita.         ché la diritta via era smarrita.
 Ahi quanto a dir qual era è cosa dura    Ahi quanto a dir qual era è cosa dura
 esta selva selvaggia e aspra e forte     esta selva selvaggia e aspra e forte
 che nel pensier rinova la paura!         che nel pensier rinova la paura!
 Tant'è amara che poco è più morte;       Tant'è amara che poco è più morte;
 ma per trattar del ben ch'i' vi trovai,  ma per trattar del ben ch'i' vi trovai,
 dirò de l'altre cose ch'i' v'ho scorte.  dirò de l'altre cose ch'i' v'ho scorte.
                     MD5                                     MD5
c7c35bbb41968390f816a8a6a6dc3932         496849de742cbdc4f7490c25f76ad798
 37     Bitcoin: Fidarsi o non Fidarsi?                           Prof. Luca Grilli, DI UniPG

           Hash: impronta digitale di un file
 Nel mezzo del cammin di nostra vita      Nel centro del cammin di nostra vita
 mi ritrovai per una selva oscura         mi ritrovai per una selva oscura
 ché la diritta via era smarrita.         ché la diritta via era smarrita.
 Ahi quanto a dir qual era è cosa dura    Ahi quanto a dir qual era è cosa dura
 esta selva selvaggia e aspra e forte     esta selva selvaggia e aspra e forte
 che nel pensier rinova la paura!         che nel pensier rinova la paura!
 Tant'è amara che poco è più morte;       Tant'è amara che poco è più morte;
 ma per trattar del ben ch'i' vi trovai,  ma per trattar del ben ch'i' vi trovai,
 dirò de l'altre cose ch'i' v'ho scorte.  dirò de l'altre cose ch'i' v'ho scorte.
                     MD5                                     MD5
c7c35bbb41968390f816a8a6a6dc3932         496849de742cbdc4f7490c25f76ad798
 38     Bitcoin: Fidarsi o non Fidarsi?                           Prof. Luca Grilli, DI UniPG

         Resistenza alla preimmagine
   • Calcolare l’hash h(m) di un messaggio m è
       relativamente facile
   • … e l’inversione di un hash noto? È ancora
       facile?
   •   Fissato un hash h’
   •   Trovare m tale che h(m) = h’
   •   … è un problema MOLTO complesso!
   •   Unico approccio noto è procedere per
       tentativi (approccio a forza bruta)
39  Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

   Invertire un hash … a forza bruta
   • h’: hash che si desidera invertire
   • PROCEDIMENTO
         – 1. generare un messaggio mi
         – 2. calcolare h(mi)
         – 3. TEST: h(mi) coincide con h’?
                • 3.a SE esito TEST posito <U+F0DE> mi è una soluzione
                  accettabile
                • 3.b SE esito TEST negativo <U+F0DE> ritornare al punto 1.
40  Bitcoin: Fidarsi o non Fidarsi?                    Prof. Luca Grilli, DI UniPG

     Quanti tentativi (statisticamente)?
   • Mediamente circa metà dei possibili hash
         – 2127 per hash a 128 bit
         – 2255 per hash a 256 bit
         – Quanto tempo ci vuole, insomma?
                • con una CPU molto potente
                • 1 tentativo in 1 nanosecondo
                • numero medio di tentativi: 2127 <U+F040> 100.3<U+F0D7>127 <U+F040> 1038
                • <U+F0DE> necessari in media 1029 secondi
                • <U+F0DE> più di 1021 anni
41  Bitcoin: Fidarsi o non Fidarsi?                      Prof. Luca Grilli, DI UniPG

                         Inversione parziale
   • A volte può interessare trovare
         – un messaggio m
         – tale che h(m) abbia una struttura parzialmente
             prefissata
   • Esempio
         – h(m) deve iniziare con k bit (64 bit) nulli
    00000000000000007fe93b67d1f3caf9d76f7973b16049400a1145ff2ad6f38a
         – <U+F0DE> necessari mediamente 2k-1 tentativi
         – k = 64 bit <U+F0DE> 263 <U+F040> 100.3<U+F0D7>63 <U+F040> 1018.9
42  Bitcoin: Fidarsi o non Fidarsi?                  Prof. Luca Grilli, DI UniPG

                 Resistenza alle collisioni
   • È computazionalmente infattibile trovare
       due messaggi m1 e m2 tali che h(m1) = h(m2)
   • Anche in questo caso solo approcci a forza
       bruta sono noti
   • Si dimostra che sono richiesti, in media, 2k/2
       tentativi
         – 264 per hash a 128 bit
         – 2128 per hash a 256 bit
43  Bitcoin: Fidarsi o non Fidarsi?      Prof. Luca Grilli, DI UniPG

    Come funziona il Bitcoin?
44 Bitcoin: Fidarsi o non Fidarsi? Prof. Luca Grilli, DI UniPG

               … transazioni in Bitcoin …
45 Bitcoin: Fidarsi o non Fidarsi?      Prof. Luca Grilli, DI UniPG

     BTC prevede transazioni anonime
                                                                  PRuis1
             PRuis1                                               PUuis1
             PUuis1                   Transazione        2 BTC
                        5 BTC              in
                                        Bitcoin          3 BTC
   uis1 is identified by PUuis1,                                   PRuis2
   he/she is the owner of PRuis1,                                  PUuis2
   but who is uis1?
                           <U+2211> BTC input ˜ <U+2211> BTC output
                      usati solo codici identificativi anonimi
                             tipicamente chiavi pubbliche
                   <U+F0DE>difficile risalire alle identità
46 Bitcoin: Fidarsi o non Fidarsi?                        Prof. Luca Grilli, DI UniPG

            … anonimato rafforzato da …
     – ogni soggetto può avere un numero arbitrario
         di codici anonimi (pseudonimi)
     – <U+F0DE> transazioni verso se stessi non riconoscibili
                                   PRuis1 PRuis2  PRuis3    PRuis4
                                   PUuis1 PUuis2  PUuis3    PUuis4
                                   PRuis5 PRuis6  PRuis7    PRuis8
                                   PUuis5 PUuis6  PUuis7    PUuis8
                                   PRuis9 PRuis10 PRuis11   PRuis12
                                   PUuis9 PUuis10 PUuis11   PUuis12
     una coppia PU, PR non viene assegnata da una autority
                        ma è generata dal suo proprietario
47 Bitcoin: Fidarsi o non Fidarsi?                       Prof. Luca Grilli, DI UniPG

            … anonimato rafforzato da …
                                                       PRuis3
      PRuis1                                           PUuis3
      PUuis1                       Transazione 2 BTC
                 5 BTC                  in
                                     Bitcoin   3 BTC
                                                        PRuis2
                                                        PUuis2
            è possibile che uis1, uis2 e uis3
                    siano la stessa persona!!
48 Bitcoin: Fidarsi o non Fidarsi?                   Prof. Luca Grilli, DI UniPG

         Bitcoin: dati di una transazione
                                                       PRuis3
      PRuis1                                           PUuis3
      PUuis1                       Transazione 2 BTC
                 5 BTC                   in
                                      Bitcoin  3 BTC
                                                        PRuis2
                                        hash
                                                        PUuis2
                                       input
                                      output
                                     signature
49 Bitcoin: Fidarsi o non Fidarsi?                   Prof. Luca Grilli, DI UniPG

                                                               PRuis3
                    PRuis1                                     PUuis3
                    PUuis1                Transazione    2 BTC
                         5 BTC                 in
                                            Bitcoin      3 BTC
                                                              PRuis2
                                                              PUuis2
                             hash: b6b89c32………….beca582b
                             input
                               prevTxHash: 78e7f……….a14fc5
                               n: 2
                             output
                               value:  3.00000000 BTC
                               PUuis2: 66be69ac………e27dcfe7                   SHA-256
                               value:  2.00000000 BTC
                               PUuis3: 4687ac23………9cdb80f2
                             signature
 sign(•, •)
16    Bitcoin: Fidarsi o non ff4f0466………………….6dd0232f
                             Fidarsi?                            Prof. Luca Grilli, DI UniPG

                                                                                    PRuis3
                                       PRuis1                                       PUuis3
        Transazione                    PUuis1
         precedente                                  Transazione          2 BTC
                                          5 BTC           in
                                                       Bitcoin            3 BTC
                                                                                  PRuis2
                                                                                  PUuis2
hash: 78e7f76fe……….3ecda14fc5                   hash: b6b89c32………….beca582b
input                                           input
                       …..                        prevTxHash: 78e7f……….a14fc5
                       …..                        n: 2
output                                          output
                       …..                        value:   3.00000000 BTC
                       …..                        PUuis2:  66be69ac………e27dcfe7
  PUuis1: ff32aadc………7243fa12                     value:   2.00000000 BTC
                                                  PUuis3:  4687ac23………9cdb80f2
signature                                       signature
6ea2ee99………………….1acbbbf                         ff4f0466………………….6dd0232f
16     Bitcoin: Fidarsi o non Fidarsi?                             Prof. Luca Grilli, DI UniPG
chiave pubblica per verifica firma

        Firmatario di una transazione
   • Il proprietario dei 5 BTC in input alla
       transazione, firma la transazione
         – per verificare l’autenticità della firma serve la
             chiave pubblica di tale proprietario
                • che deve essere contenuta nella transazione
                  precedente quella corrente
         – nella sezione input della transazione corrente
             è inserito l’hash della precedente transazione
         – <U+F0DE> concatenamento (o catena) delle
             proprietà
52  Bitcoin: Fidarsi o non Fidarsi?                    Prof. Luca Grilli, DI UniPG

         Emissione e catena delle proprietà
    Tx0                      Tx1                         Txn-1                     Txn
      hash                      hash                        hash                     hash
   input: Ø                     input                      input                    input
    output                     output                     output                   output
   signature                 signature                   signature               signature
                         possibile verificare tutta la catena (storia)
                                  dall’emissione dei bitcoin in Tx0
                                   fino all’ultima transazione Txn
                              Irreversibilità/integrità transazioni
                       una modifica dei dati di una transazione Txi
                    <U+F0DE> invalida Txi e tutte le successive transazioni
53      Bitcoin: Fidarsi o non Fidarsi?                            Prof. Luca Grilli, DI UniPG

            Portafoglio virtuale (eWallet)
                                                                   PRuis3
    PRuis1                                                         PUuis3
    PUuis1
                            5 BTC   Transazione
                                         in
                                      Bitcoin
                                                                   PRuis2
                               portafoglio virtuale                PUuis2
       semplice software per eseguire transazioni
54 Bitcoin: Fidarsi o non Fidarsi?                  Prof. Luca Grilli, DI UniPG

                     Scegli il tuo portafoglio
55 Bitcoin: Fidarsi o non Fidarsi?           Prof. Luca Grilli, DI UniPG

                     … ma la firma digitale
          non risolve tutti i problemi …
56 Bitcoin: Fidarsi o non Fidarsi?          Prof. Luca Grilli, DI UniPG

      Attenzione al double spending
   • Il problema del double-spending rimane!
         – un utente può effettuare una transazione se è il
             proprietario dei bitcoin in input
         – <U+F0DE> la firma digitale non gli impedisce di ripeterla
             in seguito anche se non è più il proprietario
   • Unica soluzione possibile
         – tracciare e archiviare tutte le transazioni valide
             eseguite da tutti gli utenti
         – una transazione non appartenente all’archivio
             non può ritenersi valida
57  Bitcoin: Fidarsi o non Fidarsi?                 Prof. Luca Grilli, DI UniPG

               … ma chi traccia, valida e
                   archivia le transazioni?
58 Bitcoin: Fidarsi o non Fidarsi?         Prof. Luca Grilli, DI UniPG

      Tracciare, archiviare, validare … chi?
                                                                PRuis3
                                                                PUuis3
PRuis1                                 unica entità
PUuis1
                          5 BTC
                             hash
                            input
                           output
                          signature                              PRuis2
                                                                 PUuis2
            Nakamoto: “soluzione INACCETTABILE
 59
               si riottiene un unico intermediario”
       Bitcoin: Fidarsi o non Fidarsi?              Prof. Luca Grilli, DI UniPG

        Soluzione: rete Peer-to-Peer (P2P)
                                                            PRuis3
                                                            PUuis3
PRuis1
PUuis1
                          5 BTC
                             hash
                            input
                           output
                          signature    Rete P2P              PRuis2
                                                             PUuis2
 60    Bitcoin: Fidarsi o non Fidarsi?          Prof. Luca Grilli, DI UniPG

          Blocco (accettabile) di transazioni
 hash: 0000000000000000029df077……...58518d49e3e693
 header
 prevBlockHash: 00000000000000000fe93b67.……...d6f38a
 mrklRootHash: d891b6185b013c9f0bb7c0e4………65bbe6
 time: 1397034462
  nonce: 930336509
 transactions                                                            SHA-256
       hash             hash                  hash      hash
      input             input                input     input
     output            output               output    output
    signature        signature             signature signature
l’hash (256 bit) di un blocco deve iniziare con almeno 68 bit a 0
<U+F0DE> inserito il campo nonce nell’header
<U+F0DE>16ad ogni        tentativo il nonce viene incrementato di
           Bitcoin: Fidarsi o non Fidarsi?
                                                                  una unità
                                                               Prof. Luca Grilli, DI UniPG

             Un blocco NON accettabile
hash: da8510cd48ff2319fc999ac……...07fdefca01deca4023
header
prevBlockHash: 00000000000000007fe93b67.……...d6f38a
mrklRootHash: d891b6185b013c9f0bb7c0e4………65bbe6
time: 1397034462
 nonce: 1
transactions                                            SHA-256
      hash      hash               hash        hash
     input      input              input      input
    output     output             output     output
   signature signature          signature   signature
  blocco non accettabile: il suo hash non inizia con 68 bit a 0

        Trovare un blocco accettabile
   • Approccio a forza bruta
         – 1. poni nonce = 1
         – 2. calcola l’hash del blocco
         – 3. TEST: l’hash ottenuto inizia con almeno 68 bit
             nulli?
                • 3.a SE esito positivo: il blocco è valido
                • 3.b SE esito negativo: poni nonce = 2 e ritorna al punto 2.
   • Necessari mediamente 267 tentativi
   • <U+F0DE> tale processo è noto come
                            proof-of-work
63  Bitcoin: Fidarsi o non Fidarsi?                          Prof. Luca Grilli, DI UniPG

            Blocco accettabile di transazioni
hash: 0000000000000000029df077……...58518d49e3e693
header
prevBlockHash: 00000000000000000fe93b67.……...d6f38a
mrklRootHash: d891b6185b013c9f0bb7c0e4………65bbe6
time: 1397034462
 nonce: 930336509
transactions                                                           SHA-256
       hash             hash                  hash      hash
      input             input                input     input
     output            output               output    output
    signature        signature             signature signature
                   time: timestamp del momento in cui
 il16blocco         valido
           Bitcoin: Fidarsi                                    individuato
                                  (o meglio il nonce) è statoProf.
                            o non Fidarsi?                         Luca Grilli, DI UniPG

                 Concatenazione dei blocchi
     B1                            B2                         Bn-1                      Bn
hash                         hash                         hash                   hash
header                       header                       header                 header
prevBlockHash                prevBlockHash                prevBlockHash          prevBlockHash
transactions                 transactions                 transactions           transactions
                       irreversibilità/integrità transazioni
                      una modifica dei dati di una blocco Bi
 16                 <U+F0DE> invalida
         Bitcoin: Fidarsi o non Fidarsi? Bi e tutti i blocchi successiviProf. Luca Grilli, DI UniPG

     Rete P2P: algoritmo distribuito
   • Catena dei blocchi creata dalla rete P2P
         – 1) transazioni recenti (non appartenenti ad
             alcun blocco della catena) sono annunciate a
             tutti i nodi
         – 2) ogni nodo colleziona transazioni recenti in
             un blocco
         – 3) ogni nodo cerca una proof-of-work per il suo
             blocco
         – 4) non appena un nodo trova una proof-of-
             work, invia in broadcast il blocco a tutti i nodi
66  Bitcoin: Fidarsi o non Fidarsi?              Prof. Luca Grilli, DI UniPG

    Rete P2P: algoritmo distribuito
        – 5) i nodi accettano il blocco soltanto se tutte le
            transazioni che contiene sono valide e non già
            spese
        – 6) i nodi esprimono l’accettazione di un blocco
            Bi cercando il prossimo blocco Bi+1 e
            concatenando questi a Bi
               • cioè inserendo l’hash di Bi nel campo prevBlockHash
                 del blocco Bi+1
67 Bitcoin: Fidarsi o non Fidarsi?                     Prof. Luca Grilli, DI UniPG

          Verità diverse … catene diverse
   • Due nodi X e Y potrebbero annunciare
       “simultaneamente” due versioni distinte
       B.Xn e B.Yn del prossimo blocco della catena
                                                          B.Xn
        B1                         B2 Bn-1
                                                          B.Yn
68  Bitcoin: Fidarsi o non Fidarsi?        Prof. Luca Grilli, DI UniPG

     Gestione biforcazioni temporanee
   • In caso di biforcazione ogni nodo accetta
       temporaneamente come ultimo blocco quello
       ricevuto per primo
         – B.Xn se riceve prima B.Xn di B.Yn
         – B.Yn se riceve prima B.Yn di B.Yn
   • Tuttavia, non rigetta l’altro blocco e
       temporaneamente gestisce anche l’altro ramo
         – se riceve annunci di blocchi da concatenare a questi
             esegue la concatenazione
69  Bitcoin: Fidarsi o non Fidarsi?              Prof. Luca Grilli, DI UniPG

               Discernere tra due verità
   • Il ramo “vero” viene deciso in base alla sua
       lunghezza
   • EURISTICA
         – il ramo che cresce più velocemente è quello
             accettato
         – il ramo (o i rami) più corto viene respinto
70  Bitcoin: Fidarsi o non Fidarsi?             Prof. Luca Grilli, DI UniPG

      … sulla lunghezza delle catene
        – Ipotizzando che i nodi onesti dispongano di
            maggiori risorse di calcolo di quelli disonesti
        – Anche nel caso di attacco coordinato (Bizantino)
        – Nakamoto mostra che
        – la probabilità di accettare una catena con blocchi
            contraffatti tende a zero rapidamente se il criterio
            di scelta è quello della lunghezza
               • una differenza di lunghezza pari a 6,7 blocchi è
                 ampiamente sufficiente
71 Bitcoin: Fidarsi o non Fidarsi?                          Prof. Luca Grilli, DI UniPG

   Pochi blocchi in più per decidere
                                   in pratica una transazione viene
                                   confermata quando appartiene ad
                                   un blocco distante almeno 6,7
                                   blocchi dall’estremità della catena
72 Bitcoin: Fidarsi o non Fidarsi?                        Prof. Luca Grilli, DI UniPG

      Incentivi ai nodi della rete P2P
   • Commissione (Fee)
         – ogni nodo riceve una piccola commissione (o
             donazione) per ogni transazione associata ad
             una sua proof-of-work
   • Emissione di nuovi BTC (Mining)
         – ogni blocco contiene una transazione speciale
             che emette un valore prefissato di BTC (oggi
             12.5 BTC) assegnati al nodo che ha realizzato
             la proof-of-work
73  Bitcoin: Fidarsi o non Fidarsi?             Prof. Luca Grilli, DI UniPG

                          Chi stampa i BTC?
   • L’emissione di BTC non dipende da
       decisioni “politiche”
   • Già è stato stabilito il limite massimo di
       BTC che saranno emessi (21 milioni)
   • Oggi, chi risolve una proof-of-work
       emette 12.5 BTC
         – inizialmente erano 50 BTC
         – ogni quattro anni si dimezza l’incentivo
74  Bitcoin: Fidarsi o non Fidarsi?            Prof. Luca Grilli, DI UniPG

                                    Conclusioni
   • Difficile fare previsioni sul futuro del BTC
       inteso come critto-valuta
   • Riguardo alla tecnologia BTC, cioè la
       blockchain, già invece possiamo parlare di
       successo
         – esistono diverse varianti di blockchain
         – alcune che permettono di eseguire task
             programmabili (smart contract)
75  Bitcoin: Fidarsi o non Fidarsi?             Prof. Luca Grilli, DI UniPG

                  Alcune fonti consultate
   • Bitcoin: A Peer-to-Peer Electronic Cash System
       Satoshi Nakamoto
   • Wikipedia (it,en)
   • Bitcoin wiki https://it.bitcoin.it/wiki
   • Bitcoin Block Explorer http://blockexplorer.com
   • Blockchain http://blockchain.info/it
76  Bitcoin: Fidarsi o non Fidarsi?          Prof. Luca Grilli, DI UniPG

         Grazie per l’attenzione
77 Bitcoin: Fidarsi o non Fidarsi? Prof. Luca Grilli, DI UniPG

16 Bitcoin: Fidarsi o non Fidarsi? Prof. Luca Grilli, DI UniPG
